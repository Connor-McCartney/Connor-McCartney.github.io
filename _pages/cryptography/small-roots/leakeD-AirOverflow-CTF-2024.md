---
permalink: /cryptography/small-roots/leakeD-AirOverflow-CTF-2024
title: leakeD - AirOverflow CTF 2024
---

<br>

# Challenge Files

```
n = 61603353713497481353093789761218837456348814362385572719752742165239826633059364812252664775073080419608503766824937118584276367565405119708719320286638215006454597910054035677680116864260197415814502200955093719693770917690955242561401031837258884926792556374971891937048688925497786201196485657947683940093
e = 65537
c = 55107193277806643465354234996914571876636966411485491161969324994511379928060644450385185733887883775588924346215517683693717173215542747455726024055890520942360605839189499190398912729455982335072850028769962719890485469580480502469912059097824663688877477640889793537652387043555868600302643800484069070010
d_low = 3043961376216184695115588290773915275797924871447606123516914996499688086769
```

<br>

# Testing

I'm just going to guess that phi is (p-1)(q-1) and not lcm(p-1, q-1). 

```python
sage: n.nbits()
1023
sage: d_low.nbits()
251
```

I'll also guess that p and q are 512 bits, and d_low is d % (2**251).

Getting some dummies:

```python
from Crypto.Util.number import *

while True:
    p = ZZ(getPrime(512))
    q = ZZ(getPrime(512))
    n = p*q
    assert p.nbits() == 512
    assert q.nbits() == 512
    e = 65537
    d = pow(e, -1, (p-1)*(q-1))
    d_low = d % (2**251)

    if n.nbits() == 1023 and d_low.nbits() == 251:
        break

print(f"{p = }")
print(f"{q = }")
print(f"{n = }")
print(f"{d = }")
print(f"{d_low = }")
```

```
p = 6782714674530849259976426508049751360186275989168942150067607177158759549692136405437100822910862479101335260722971262184527791659987318821239554508058151
q = 7840470547123584187725681284025367375558199040545577189728698971372037815973624045881424210381844679613147444729238542072922131648754788534461538832717791
n = 53179674635202050949368871657079120718419337628050148344927053991859544565101418620708999248640624275541585828303315032276026672390556832031666705289168775568846944133766534180879468306173368735361104093211862900781909118505556835024325671852739982796776307691990504357988651838393629323906488670513200264441
d = 45937527510384340271078483333850545220427476720008163298640621032197881149877496848430319750126539534720238291528560517069905884879903007079614805679698825009625119138807157662636711091329552510490905026573403085136362030476465484754664615264478556225543299003067662117781023469491764785950112389410517499473
d_low = 3265656429657629381657633840473215717204898527820047416915477371037138632273
```


Solving p_low (or q_low):

```python
    k = (e*d-1) / ((p-1)*(q-1))
    #print(f"{k = }")

    var('pp')
    f = pp*(1-e*d_low) + k*(n*pp - pp**2 - n + pp) 
    def test():
        for p_low_rec in tqdm(solve_mod(f, 2**251)[::2]):
            p_low_rec = int(p_low_rec[0])
            if p_low_rec == p % 2**251 or p_low_rec == q % 2**251:
                return True
        return False
    print(test())
```
