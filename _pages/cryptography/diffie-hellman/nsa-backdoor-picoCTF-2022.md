---
permalink: /cryptography/diffie-hellman/nsa-backdoorpicoCTF-2022
title: NSA Backdoor - picoCTF 2022
---

We have $$c = 3^m \ (mod n)$$ <br>
Generally n is prime to ensure there is only one possible plaintext, but here it is the product of two primes. <br>
n can be factorised using [Pollard's p-1 algorithm](https://en.wikipedia.org/wiki/Pollard%27s_p_%E2%88%92_1_algorithm):

```python
n = 23631380600585926785034933014669778384717002763695326602525122369867329093073023095849543261734477793374653454730801073519717399439107742795306326807757602886871740112365829978576437811835126224062817694193952267560076144925721213796854723058575669797411042284965662916175847622512681733885085589458060742487272911853069476277766049668615980239317022075486115682650631671094005056107870639385097755879982581458039878851451442193867518303229722958147548922372485290004728561412073193742105935367298028196686020203765574915676292711167539990706320311622313599996769810672951287994876580490482332931013620794744320021381
p = 195689569599991573195486662969107936476327582815650265848527292065392698739110102999657954846955120594377276309675385219710107684418301519979983584109265406352906599221589048483902954646108676454613848362209453736737332026787464761559703214766984111125995768160435359003426746370976467186239394596843763939499
q = 120759530765440164788393584815198181785453365216058011221242572474857701934543658420625103273619411412685939059091676362260202826471982447213813057019415223578402663988113530890287786672842686395844059610821738383797601768012556360596829980884906822859047976972535357205380764775443960532258052851032850088083
```



```python
from sympy.ntheory.residue_ntheory import discrete_log #implements the Pohligâ€“Hellman algorithm
from Crypto.Util.number import long_to_bytes

n = 0xbb3253ebde74690fc89e70a3c9c5296270b477e75884db7513ef1a75f73042ff77d8dec694b5fa9b5457f9c576e9f83f6e1c93f463a782aeb77b617ba9cb0e91e1b6dd2159d23b245a8fae93629fe76411223534ae72d4a90b678746bccbeef6cc74e4353ed5d485e59ee8f6fbe2e862419d025a175cc16fcb2b3b62ae4df92262ce89baada0cac75354d7cdb1b0ef1b85895d14320c643b6680982fcf3db75473ab431bb613ee3bf3a128666556f71d740d9640a79fd856a51b5c1db78a97b563cdb342ccdb31278f7e32f5ea867d640ecb9385bd554e869f37f96d9baba2f094fbd0839c08d2d9e449ef0437e8c74ca82227a8c65056604433bee02193d385
c = 0x4325dc6bc786ab9dcad7dabbb9fcc74d8422a2b6c9af8257b0f70d69db9961c4ffcb300c4c69161d8e9cf4597088c845fd0df5fc3f38f52850b0dd738e536c848efb7760ce3a5969ef080b113a229b1f92fa6239a056511d64c7b9f83839735c628170f45b96cb9575ef6b4593b443ee554c8c58fef153a55202e53d2268ad687a3d73aaf9503e44788f881ea65b7ccf00d757345b831bf915b8c3bce9f5f2ab0b537f8712621a9968418d8d87726ac9233c351595065115dd2df90584e8ccf03464ad25270363755afb854afd8d68ffcefcad172974bd9439c78cd83cb19e5d59853d7f15ea95a4300f174e8d4f4bd5fb20430a43871231c3d1bc54948d2323

FLAG = discrete_log(n, c, 3)
print(long_to_bytes(FLAG).decode()) #picoCTF{49ed5f06}
```
