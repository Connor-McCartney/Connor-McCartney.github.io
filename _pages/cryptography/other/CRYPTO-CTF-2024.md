---
permalink: /cryptography/other/CRYPTO-CTF-2024
title: CRYPTO CTF 2024
---

<br>
<br>

[Challenge Files](https://github.com/Connor-McCartney/CTF_Files/tree/main/2024/CRYPTO%20CTF)

<br>

# Alibos

```python
	c = (pkey + d ** 2 * m) % (10 ** d)
```

Rearranging for m:

```python
from Crypto.Util.number import *

pkey = 8582435512564229286688465405009040056856016872134514945016805951785759509953023638490767572236748566493023965794194297026085882082781147026501124183913218900918532638964014591302221504335115379744625749001902791287122243760312557423006862735120339132655680911213722073949690947638446354528576541717311700749946777
enc  = 6314597738211377086770535291073179315279171595861180001679392971498929017818237394074266448467963648845725270238638741470530326527225591470945568628357663345362977083408459035746665948779559824189070193446347235731566688204757001867451307179564783577100125355658166518394135392082890798973020986161756145194380336

d = len(str(pkey))
m = ((enc-pkey) * pow(d**2, -1, 10**d)) % 10**d
print(m)
print(long_to_bytes(int(str(m)[:108])))

# 6170704326493336128242608193100736601774626903966803036318189045381903593682775829229200905376968543264526051111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
# CCTF{h0M3_m4De_cRyp70_5ySTeM_1N_CryptoCTF!!!}
```


# Beheaded

This was like the famous ECB penguin, you could rescale it in gimp or use a block where all pixels are the same colour without needing to find the key. 

# Mashy

Guessy trash, had to guess that sh was `a483b30944cbf762d4a3afc154aad825`. 

Then you can just send a bunch of md5 collisions, so that xor(h1, h2) is b'\x00\x00 ...'








# Forghan

```
...::::: CCTF{f!nD1N9_7wIn_5m0OtH_1nT3GErS!!!} :::::...
```

# RM2

```python
from pwn import *
from Crypto.Util.number import *
from gensafeprime import generate

io = remote('01.cr.yp.toc.tf', 13371)
io.read()

def get_super_safe_prime():
    while True:
        x = generate(1024)
        if isPrime(2*x+1):
            return x

#p = get_super_safe_prime()
#q = get_super_safe_prime()
p = 176190361114405660140775371642244103546320715334539918001492645857771593552107955448402648350633693638480545186750598651678784235721661177218038230550079910726963779269165803404500415338229375745350440434088252741915552117559295023850055262211395546349293984582637753204891730267351496766430177371001101202579
q = 174673912453530565721373096945468158471423845542688334400192438665743138238497195281153045123700977896509756132766346293652660746134615199680910832008097698850013139496501456054035329932355735673848807210672424697329408424184179185667926436594508177456167574196681896497806043904509301791431726034346952707019

io.sendline(f'{p},{q}'.encode())
c1 = int(io.readline().decode().split('= ')[1])
c2 = int(io.readline().decode().split('= ')[1])

# 	c1, c2 = pow(m1, e, (p - 1) * (q - 1)), pow(m2, e, (2*p + 1) * (2*q + 1))
e = 65537
m1=pow(c1, pow(e, -1, ((p-1)//2-1) * ((q-1)//2-1)), (p-1)*(q-1))
m2=pow(c2, pow(e, -1, 4*p*q), (2*p+1)*(2*q+1))

secret_string = long_to_bytes(m1) + long_to_bytes(m2)
io.read()
io.sendline(secret_string)
print(io.read().decode())

# CCTF{i_l0v3_5UpeR_S4fE_Pr1m3s!!}
```

# Alilbols

# Nabat

# Nazdone

# Joe-19

```python
import requests
from Crypto.Util.number import *
from tqdm import *

resp = requests.get('https://zacharyratliff.org/files/eMillionDigits.txt')
e_digits = resp.content.decode().split('\n')[4][2:]
n = 8098851734937207931222242323719278262039311278408396153102939840336549151541408692581651429325092535316359074019383926520363453725271849258924996783681725111665666420297112252565291898169877088446887149672943461236879128453847442584868198963005276340812322871768679441501282681171263391133217373094824601748838255306528243603493400515452224778867670063040337191204276832576625227337670689681430055765023322478267339944312535862682499007423158988134472889946113994555274385595499503495488202251032898470224056637967019786473820952632846823442509236976892995505554046850101313269847925347047514591030406052185186963433
c = 7109666883988892105091816608945789114105575520302872143453259352879355990908149124303310269223886289484842913063773914475282456079383409262649058768777227206800315566373109284537693635270488429501591721126853086090237488579840160957328710017268493911400151764046320861154478494943928510792105098343926542515526432005970840321142196894715037239909959538873866099850417570975505565638622448664580282210383639403173773002795595142150433695880167315674091756597784809792396452578104130341085213443116999368555639128246707794076354522200892568943534878523445909591352323861659891882091917178199085781803940677425823784662

for i in trange(len(e_digits)-154):
    for k in [154,155]:
        p = int(e_digits[i:i+k])
        if isPrime(p) and p.bit_length() == 512 and n%p == 0:
            d = pow(65537, -1, p-1)
            print(long_to_bytes(pow(c, d, p)))

# CCTF{ASIS_h1r3_7aL3nT5_t0_cO1La8orAt3_!N_Crypto_CTF!}
```

# Honey

# Ahoo

(No source provided.)

```
$ nc 00.cr.yp.toc.tf 17371
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Welcome to Ahoo task! Given integer n, find the smallest positive   ┃
┃ integer c such that n * c has the minimum number of 1 bits in its   ┃
┃ binary representation. Completing all steps will reveal the flag :) ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
┃ Please send the number of 1 bits in n * c and the integer c for
┃ n = 3823, separated by comma: 
```

Had to pass several rounds of this.

Check:

<https://arxiv.org/pdf/2002.02731>

<https://github.com/FinnLidbetter/sturdy-numbers>

# Vantuk

# Ally

Credit @ctfguy

<https://www.imo-official.org/problems/IMO2012SL.pdf>

Check N4^

```python
from pwn import remote
from Crypto.Util.number import getPrime

def get_special_prime(nbit):
    while True:
        p = getPrime(nbit)
        if p%4 == 1:
            return p

io = remote('01.cr.yp.toc.tf', '13777')
for _ in range(20):
    io.recvuntil(b'your ')
    nbit = int(io.recvuntil(b'-').decode()[:-1])
    p = get_special_prime(nbit)
    io.sendline(str(p).encode())
    k = (p-1)//4
    x, y = 2*k+1, k
    io.sendline(f"{x},{y}".encode())
io.interactive()

# CCTF{Di0phaNtinE_eQuaT1on_iZ_4n_equ4tion_wiTh_int3ger_solu7Ions_0nly!}
```

# Soufia

(No source provided.)

Credit @ctfguy

```python
from pwn import *

conn = remote('03.cr.yp.toc.tf', 13377)

def read_val(conn):
    for _ in range(4):
        print(conn.recvline().decode())

    s=conn.recvline().decode()
    print(s)
    y1 = int(s.split('=')[1].split(',')[0].strip())
    s=conn.recvline().decode()
    print(s)
    x2 = int(s.split('(')[1].split(')')[0])
    y2 = int(s.split('=')[1].split('┃')[0].strip())
    conn.recvline().decode()
    return int(0),int(x2),int(y1),int(y2)

def cal(val):
    a = (y2 - y1) // (x2 - x1)
    b = y1 - a * x1
    return (a * val) + b

x1,x2,y1,y2 = read_val(conn)
print(x1,x2,y1,y2)

s=conn.recvline().decode()
val = int(s.split('(')[1].split(')')[0])
ans=cal(val)
conn.sendline(str(ans).encode())
print(conn.recvline().decode())
def conti():
        s=conn.recvline().decode()
        print(s)
        val = int(s.split('(')[1].split(')')[0])
        ans=cal(val)
        conn.sendline(str(ans).encode())
        print(conn.recvline())

while True:
    conti()
```

```
[+] Opening connection to 03.cr.yp.toc.tf on port 13377: Done
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓

┃ .::   Soufia is a random oracle, your mission is to break it   ::. ┃

┃ We know that f: Z → Z and for all integers `x' and `y' we have:    ┃

┃     f(t * x) + t * f(y) = f(f(x + y)) for constant integer `t'.    ┃

┃ Also, f(0) = 209907020941535864741588746126965728575,              ┃

┃ and   f(91) = 1369168415328908069957513174528303837593             ┃

0 91 209907020941535864741588746126965728575 1369168415328908069957513174528303837593
┃ Good job, try the next step 2

┃ Please send the f(45):

b'\xe2\x94\x83 Good job, try the next step 3\n'
┃ Please send the f(32):

b'\xe2\x94\x83 Good job, try the next step 4\n'
┃ Please send the f(155):

b'\xe2\x94\x83 Good job, try the next step 5\n'
┃ Please send the f(356):

...

b'\xe2\x94\x83 Good job, try the next step 18\n'
┃ Please send the f(3910397):

b'\xe2\x94\x83 Good job, try the next step 19\n'
┃ Please send the f(2008442):

b'\xe2\x94\x83 Good job, try the next step 20\n'
┃ Please send the f(14329881):

b"\xe2\x94\x83 Congratz! You got the flag: b'CCTF{A_funCti0nal_3qu4tiOn_iZ_4_7yPe_oF_EquAtioN_tHaT_inv0lVe5_an_unKnOwn_funCt!on_r4tH3r_thAn_juS7_vArIabl3s!!}'\n"
```

# Melek

# Tesvir

```python
def solve_subset_mod(arr, target, m):
    M = (identity_matrix(QQ, len(arr)+1)
         .augment(vector(arr + [-target]))
         .stack(vector([0 for _ in range(len(arr))] + [0, m]))
    )

    for row in M.LLL():
        for row in (row, -row):
            sol = [i for i in row][:-1]
            if not all([i in (0, 1) for i in sol]):
                continue
            subset = [xx for xx, k in zip(arr, sol) if k]
            if sum(subset) % m == target:
                return sol

pubkey  = [92886066988388680173329582741273638432560905105902914844, 210751255343870357476757616218088120348848008067778344395, 74425909117669424902415608182276534435650370104873725226, 99181044682023732918695417999410594327236962612004062203, 184660845741344564288628118584866122028435601898518289311, 86293719592435824002495406220960151634808851208991382274, 220299683035630760097249864519724170956397691396674502351, 218079912870288780369679822368500969128910276003151222237, 14778352954258397714469938718275182936354922505384292383, 132130835649873192456001750484927359136237453044816907309, 25137623946868522616211722412394033705360632773617668353, 79901378033903357591915996829748292103112792449008643158, 57127051781577974272533361891913780075063000327051256185, 139480489738918831641105138243203041849604902804230325307, 6636221692280612206143039499477440633937028618222805297, 3772467192534577746336251743661505830547482255151794293, 12837754032587248352593907834250831316657535088858254316, 55294249969720105731143033962876859344291619766399258586, 143240945985012003565090193408824643640779930841340941384, 207298521840013369619959675764264366982562750013000422761, 19802061697642727591519306605507839521117935001927582613, 44527192516622631241657701198320138966998880114399361795, 70009063969035941644329825318467700094581525801204727181, 142703058408732671528984569801750559471281159651241652062, 172304085921330629492232337636466212102117319007604950025, 155475843345826385265987350725039300934780724029883949772, 169347599331405990514138585112678993084330188820253643457, 215416121704488916458382565818438348592001566447832598904, 188187731496431295706540560463195397867635095489841015153, 193876498460423248024056843990730327032814452611339372095, 110910914198523905354564616742390233111344563838133902268, 63827772029857861463577163755389830442651373015537598853, 201568856761103641300623283313375294858797054395206451738, 111796178976077921895334684539179530199231221192025576010, 132026503336520784756207274656596057456804846250284032339, 84285587542526127248440670614024679598468422343813253605, 159428417414783869527317183833025274975479739383901448874, 64428339570057766343470883789790396681811345808506430155, 17773178194543385480117432315047762917045147297455059068, 89512728697279216167516727754431756792239260101851927048, 190427317516825752974680525260842202533545330049265484685, 157295297961778042328619944993793385674269977225614543409, 4974170892150975824988854099057751873407321899766994340, 76151972747505832903312296911458066375836111785170954818, 12780621873862922185963594441840408184697766338606725088, 215891915752015869692717275983217322389954147748038149913, 84672037040784935027771519744002727929035411856418295454, 173377172838515603000763109043635713007444376906312785659, 78825027684341059289379270568982587949492842296580685210, 196319411406577160369249468485354959923499881172752370432, 149632537749145022633698878910422597383394761669508775150, 61215274442358408619312704383732009988429752954976434510, 121617939993268547670556056131391352859594688618055273649, 92683023247453538925416294521734179142466406393402165284, 179081918128905986721209486399492233572685281618904277134, 128127945519288006079855900928579345964821914461244666859, 16867099283533376487721035923318497964272934855546093439, 154997822809931133447394923168284413679035824785745194730, 173682328462179058005003161191680769654245300801521009879, 130155296795876399873497236725802378282692937340062237935, 6671586303725645410980753139195927682320190581348797818, 152943065825990505253224485604590561843118102831476724085, 76097330619185109304052467189304594887923532251137153504, 185135141194334724407844282883457326900162249009549345831, 10921483287230916182817512596921390357752886208282706876, 151271927039684184070498738116172072543518713480677091079, 136298030618749815703864675278527025088371447385571482978, 4758776794002838133449795605623779838661247306079090347, 19981114149609902678102199302508388417345988817824030366, 73938677992611844289158171248381726517745556187533617067, 154379344389348822626282095279797153064835052505876799368, 213360480891633535236181458572407095838836152782860588104, 198510199654805189509342596145689894869725018759903041507, 14267132365366134640075375788531621241572826565872424420, 125322641872109533742616867834123368413937890142250166210, 27761695413361618125181147472312882304612603261326567738, 176074098184367588496084722561712203577297987249156695996, 184825512648696203391868022338025767151276944108604105240, 76445117428817751907469654995811477620910303139855603430, 82665582153218489938826943118869996114191197883710823609, 146938316278530866657441207271230294849424101841476702684, 175735365800930965503156619292636366172726729000960012747, 76108412191983352914624831771577340649664462133681354257, 51216505200491353565628514314075841932869368671909611422, 204239406328039235742654863605657881024731770195373503166, 35077608369166363077290419165539308358044372399596051949, 141346950768818454305723443861759686267961194829785415155, 172150098196192354246034454655216693215452009432898901427, 82990067238658606054849825844886372090364773033126485587, 112038315092606359027221487184783803870421704581266936708, 58914659964881731037335471016191730563863425144352336943, 128457823796249561970005313037687944811941419913016496383, 213337871687450072917189488472078380744945853754387250512, 191892726995974949469114178871749804387259634590458908936, 176112380139134647655398805139300913670784775509195354445, 144740992869587974310090799803527129516554701599543463160, 111678206994513803125019555945498901679134121690878426828, 212378272583651446176097053495838205426261001439753481779, 30270421099323796173018087600030956325784109844975963318, 24667784976110977811287463198349391182061026177610928267, 58648685934430390399131245710068712256688250896733427433, 226288351225600375693429144741635573530336955157491657406, 2234225503811661632319718142798855751866036485696580852, 121797356235039478737766390441090317882711507703565373226, 101297006853275402861966500913834813565543444865413634087, 162579081001936368615348051777628179506904525245133047164, 25157488109407946030153114849594555538316839672959711563, 88061984254829379097942516994529815597150987399072364336, 42688530758895174674193186730994655264010420201719243433, 4460090661692805202749850983805143841415378613652836846, 30088825985014846600387007682131860206839260053034513849, 200054261203129307816182870092417959615219353804985049450, 140849799897717905135153922792539839975896769827334038275, 98760545087771244563146940499391962327892043011670296574, 25180075852456461545668509099653490611752856235335415515, 157279073723626343268408966659119242174681449600046327491, 211533443731232207958382797927578368253470063323385415305, 194524863955971259753051926427267579197016195487315353155, 83751248535513145355660506770897482801030224059963389408, 115138349873074658192267411096122845105999530350763854655, 215600522608166725448707314656579650654515052268673308760, 10796034267879362998642448011756079795116267404224800855, 111832068852177640954078305890771947542980712902669315475, 200469150388653842509392959061011176435466551051326498668, 30726612920161727945717775737198729041541528543188078985, 47239465143611863240261597547409077261966220932690083608, 172702523884923029857632413645581266015574385393550030383, 160627476423178758050783866311020106650977166828135718677, 128551461965426470262450322709691684846516421067158247593, 149070893501618995889804678789784488223110157086998320190, 195544453239680309080864718376343768660793419344309015371, 77811783271576363509563966728389456349963507382460515159, 174278317100602890982289959796479144491641180003422318402, 73378410370770578287641255812076589713277634648053702393, 141743373303620859387809446917135848276524237197935139251, 107180666443942227975559795572883017760896436280408642836, 204466619320963270815953280672596862351439649087459080330, 54607085224440389336692259961948432872409040643712187196, 90892438801687444302363910922001469380485547602072056312, 116495323168693640880821115186026787669589735848974550271, 150401470283271988559117977784854104521296931907607110486, 154090517125971562516821679404817371275277406532781405647, 104678342752350974596101104366129755083070849881860226748, 157978012412333596540548315887518551041118501217715507693, 163303626174887158945343733366789836669913574237379259572, 181001953193184678814047746174416210735032292122737633102, 28520747201490566067980511495227121600982304748050536315, 202299150875669157121378795139833033891742976498092748326, 970899112734507435107978511253698562255021879789329622, 146598329156514558782950920101145863079889367928807975977, 161170854382197314019269906577394809052106378415918331111, 59062428764150593381983742288693555245406391510971163517, 76915433679990371556167855027708867665365400330733169618, 89501651017657171486735552504919601126514100477053545598, 155730958643627207880319610446663976356182855717274760915, 153319504596278295124327612654967413427190499811068175141, 55143199482129353190020980489571171227799463580932543507, 65867578091352179883803350861852268522863534472063121536, 185253942450370609764295976829306672581940464194975155370, 45998515564234600522974603054023511905075650998614365022, 202037532932391272684290723543081742411941903511422568693, 193437603469571773588721936014856408564274364378112176998, 40966814823621126092043598001247946528303483900490631243, 96180297695543903574648581153841041196995524933892692619, 7434236946247395721737460702125068355596232961041228531, 184321353327002489735745646530281708427284036005568776658, 140177181342986706305442328349507660746632700762773335854, 62185321216695795974582214400857301435242625860427058504, 76430389183686943120515253756245781025593330606869771215, 78619517512809385276713151495590149773001915050796364065, 79421522371486140966131803689265908515929863724624939864, 22129537950071912479413632578731336002900774566274025350, 197085073703705733810640962347618181728732561497159780282, 181724715254608855641693163729986494116649983589787609407, 124597957745948567633299678917630875794686726927368990429, 27273213841358296776578768184430928671018080941174807840, 152776522190630131246760748430764619655533175607985589836, 48681268809666830266159835476955141416750705899024875974, 89317244917173433349320258645687517717239384663894566278, 201257702236516361405257981510601612114484277702528603943, 87519410092330942709078977446738925665582243816920367744, 177787387494070159450445481317677026153613266023935751281, 24643205402954723090911892051677522488215459066647382714, 56590062223369038528065649254743241674141446454079839579, 179396400905232822865797012959623450133279154279097379051, 30025313395744011254406844462499704950426511512721337841, 83276838850321885112545153165158569714460607766826121135, 68646151543586256303371147554134648353111280212178713752, 87495786295097875957094843643092630530679785357906500378, 222465857206064556670796535989384593676021996740717427241, 110523306528201080754549704134151152305839064772192522439, 26464048540106421248631062043107233895602381285227483920, 145627987132012795205161372829205758041070489765824489859, 193297733586259333458497049150053222412825014105379541387, 26111736920859807974906629858040408870103481081762161325, 55771701249405168670677160717676511083556774856113587797, 189736239093660724751567045325664782250505266726265886301, 161804560602042832539413084827420388198122805811609462668, 203009995021523304957205919345868213530963925564563615473, 90774798965018540890715656649222210633732452506467954902, 225895202989665665828020049279241974570875711586953870572, 218526549874566716275818926298716226779897994684061293418, 131530479475390722696235276845265596381662910299437131301, 72620232900742232429463502446535378811959678254536979604, 37546163510027376473170898762960473894255918124633338415, 143001879280256363624803066346210337300340423105921577120, 165329409306715276877210964642484011103648994170410031402, 4814907793328147487310168483966089518302106121666337453, 51312524070257917838368408186468441732503299101638317043, 86662571838604232113504553386409229105778273252765707836, 62213997296769879553198182504582088960032151319109241629, 200406934649320768037667962927866428421277977046695072270, 92470224199301497961555930909174852382352507364774469356, 21594911171913776918052060504197855262578419645616335604, 29011150339088209488103721928958817626907010842053899941, 8372898414227573449442990910059289890284123168261547531, 169961592178907939509522133503409794844895818074560168428, 173004823566201448576476592934121715356651376842721997619, 169157072568524836382074106405055305528383450896499626160, 186490359160732656419875466468508581711232527708974028426, 12660075658562618970962317520287968826117547712067755493, 86613911921221949822767544058543773067024167756340760277, 25878398193015129175197412426814597205797037745809900508]
enc = [187335580574061707931829069116893046450217737977325200745, 23044036808650474215359961752968190941949563626346145378, 15472607588253013011000486526821636805918664553516618358, 220564948069930322910342336229099484559121538170035160014, 74457707396243578866974467699987135325106221370053143511, 191844788154252149258813565888783499484598821383178275043, 59281299146214117805262571323958482102338248792701470905, 58087015188935841816071445240786563506121906740551194689, 130642627083773736940245456608059246927502638073319678670, 225120950466145061336433324767380851216550581530569663094, 115988089900656782972089910677319239346851295885744890049, 82861550277425149901583976607081827058011437360125240204, 157911333117268625551061805625122605155252264343038082111, 70418826087219797756008213894640219758929295365347469130, 149526656617309347299553804390924844369186967346096045202, 196748731334848074105092056876949001467041097522100070418, 209630245143058356288710962132847621537804601934377712911, 214956094413732365297703489096292627646807106134017187223]
p, h = 223, 24
q = p**h - 1
pubkeys = pubkey[:h] + pubkey[-h:]

flag = ""
for e in enc:
    sol = solve_subset_mod(pubkeys, e, q)
    flag += "".join(str(_) for _ in sol[:h])
print(bytes.fromhex(f'{int(flag, 2):02x}'))

# CCTF{9j_h0W_dO_yUo_5oLvE_tH!s_m1X3D_5eMi_H4rD_T4Sk!!!?}
```

# Solmaz

```python
px, py = (1338, 9218578132576071095213927906233283616907115389852794510465118810355739314264)
qx, qy = (3454561753909947353764378180794889923919743476068813953002808647958908878895, 17267599534808803050751150297274989016063324917454246976792837120400888025519)
A = qx*(py^2-px^3) - px*(qy^2-qx^3)
p = 30126567747372029007183424263223733382328264316268541293679065617875255137317
assert A%p == 0

c = (py^2 - px^3) * pow(px, -1, p) % p
E = EllipticCurve(GF(p), [c, 0])
P = E(px, py)
Q = E(qx, qy)
m = Q.log(P)
print(bytes.fromhex(f'{m:02x}'))
# 3cC_d1ViSibil!7Y
```


# Rehawk

<https://gitlab.inria.fr/capsule/code-for-module-lip/-/blob/main/attack/attack_Hawk_totally_real.sage>

